"""Bootstrap generator for survey automation artifacts.\n\nRunning this script will deterministically overwrite bootstrap scaffolding files\nusing the canonical contents tracked in version control.\n"""\nfrom __future__ import annotations\n\nfrom pathlib import Path\n\nSEED = 20251016\n\nFILES = {\n    "docs/codebook.json": """{\n  \\\"dataset\\\": \\\"childhoodbalancedpublic_original.csv\\\",\n  \\\"seed\\\": 20251016,\n  \\\"description\\\": \\\"Placeholder codebook. TODO: Replace with detailed variable metadata verified against raw instrument.\\\",\n  \\\"variables\\\": {\n    \\\"selfage\\\": {\n      \\\"label\\\": \\\"Respondent age in years\\\",\n      \\\"question\\\": \\\"Your age?\\\",\n      \\\"type\\\": \\\"numeric\\\",\n      \\\"allowed_values\\\": null,\n      \\\"notes\\\": \\\"TODO: Confirm units and imputation rules.\\\"\n    },\n    \\\"biomale\\\": {\n      \\\"label\\\": \\\"Biological sex is male\\\",\n      \\\"question\\\": \\\"Which category fits you best?\\\",\n      \\\"type\\\": \\\"binary\\\",\n      \\\"allowed_values\\\": [0, 1],\n      \\\"notes\\\": \\\"TODO: Verify coding (1=male?).\\\"\n    },\n    \\\"liberal\\\": {\n      \\\"label\\\": \\\"Political orientation: liberal scale\\\",\n      \\\"question\\\": \\\"Politically speaking, you tend to be more:\\",\n      \\\"type\\\": \\\"ordinal\\\",\n      \\\"allowed_values\\\": \\\"TODO\\\",\n      \\\"notes\\\": \\\"TODO: Map response options to codes.\\\"\n    },\n    \\\"religion\\\": {\n      \\\"label\\\": \\\"Currently practices a religion\\\",\n      \\\"question\\\": \\\"Do you currently actively practice a religion?\\\",\n      \\\"type\\\": \\\"categorical\\\",\n      \\\"allowed_values\\\": \\\"TODO\\\",\n      \\\"notes\\\": \\\"TODO: Add response levels.\\\"\n    },\n    \\\"networth\\\": {\n      \\\"label\\\": \\\"Current net worth bracket\\\",\n      \\\"question\\\": \\\"Your current net worth is closest to\\\",\n      \\\"type\\\": \\\"ordinal\\\",\n      \\\"allowed_values\\\": \\\"TODO\\\",\n      \\\"notes\\\": \\\"TODO: Confirm brackets and order.\\\"\n    }\n  },\n  \\\"pending_tasks\\\": [\n    \\\"Validate variable list completeness\\\",\n    \\\"Document derived variables and missing value codes\\\",\n    \\\"Cross-reference survey instrument for canonical wording\\\"\n  ]\n}\n""",\n    "docs/survey_design.yaml": """dataset: childhoodbalancedpublic_original.csv\nseed: 20251016\nweight_variable: TODO  # TODO: confirm primary weight variable name if available\nstrata_variable: null  # TODO: populate if stratification exists\ncluster_variable: null  # TODO: populate with PSU identifier if applicable\nreplicate_weights: []  # TODO: add jackknife/BRR replicate weight variable names if provided\nfinite_population_correction: null\nnotes:\n  - \\\"Verify whether the dataset includes calibrated survey weights.\\\"\n  - \\\"Document variance estimation method (Taylor vs. replicate-based) once known.\\\"\n  - \\\"Ensure design metadata aligns with docs/codebook.json before analysis.\\\"\n""",\n    "config/agent_config.yaml": """seed: 20251016\nrandom_state_overrides: {}\nreproducibility:\n  deterministic: true\n  log_commands: true\n  notes: \\\"All analyses must record seed and CLI commands in artifacts/state.json or downstream manifests.\\\"\nprivacy:\n  min_cell_size: 10\n  suppress_small_cells: true\nanalysis_defaults:\n  weight_variable: TODO  # TODO: update once survey weight is confirmed\n  strata_variable: null\n  cluster_variable: null\n  replicate_weights: []\n  variance_method: \\\"taylor\\\"  # TODO: revise if replicate weights supplied\nbudgets:\n  max_loops: 30\n  runtime_minutes: 480\n  storage_mb: 500\nthresholds:\n  convergence_delta: 1e-4\n  max_missingness: 0.2\n  min_effect_size: 0.1\nreporting:\n  maintain_manuscript_tex: true\n  manuscript_path: manuscript.tex\n""",\n    "artifacts/state.json": """{\n  \\\"seed\\\": 20251016,\n  \\\"loop_counter\\\": 0,\n  \\\"total_loops\\\": 30,\n  \\\"bootstrap_complete\\\": true,\n  \\\"backlog\\\": [\n    {\n      \\\"id\\\": \\\"T-001\\\",\n      \\\"description\\\": \\\"Validate survey weights and replicate design metadata\\\",\n      \\\"priority\\\": 1,\n      \\\"status\\\": \\\"todo\\\"\n    },\n    {\n      \\\"id\\\": \\\"T-002\\\",\n      \\\"description\\\": \\\"Generate exploratory weighted summaries for key outcomes\\\",\n      \\\"priority\\\": 2,\n      \\\"status\\\": \\\"todo\\\"\n    }\n  ],\n  \\\"next_actions\\\": [\\\"T-001\\\", \\\"T-002\\\"],\n  \\\"artifacts\\\": {\n    \\\"hypotheses_registry\\\": \\\"analysis/hypotheses.csv\\\",\n    \\\"pre_analysis_plan\\\": \\\"analysis/pre_analysis_plan.md\\\",\n    \\\"research_notebook\\\": \\\"notebooks/research_notebook.md\\\"\n  },\n  \\\"regeneration_commands\\\": {\n    \\\"bootstrap\\\": \\\"python scripts/bootstrap_artifacts.py\\\"\n  }\n}\n""",\n    "analysis/hypotheses.csv": """hypothesis_id,hypothesis_text,priority,variables,status,notes\nH-000,\\\"TODO: replace with specific hypothesis once confirmed\\\",0,\\\"[]\\\",\\\"draft\\\",\\\"Bootstrap placeholder\\\"\n""",\n    "analysis/pre_analysis_plan.md": """# Pre-Analysis Plan (Draft)\n\n**Seed:** 20251016  \n**Regeneration command:** `python scripts/bootstrap_artifacts.py`\n\n## Project Overview\nThis document sketches the initial analytic roadmap for the childhood balance public survey. It is a living draft that will be versioned until the PAP is frozen. The plan prioritizes reproducibility, privacy (minimum cell size = 10), and alignment between Markdown deliverables and the future LaTeX manuscript (`manuscript.tex`).\n\n## Data & Design Inputs\n- Primary dataset: `childhoodbalancedpublic_original.csv` (read-only source).\n- Metadata: `docs/codebook.json` (variable stubs) and `docs/survey_design.yaml` (design placeholders).\n- Weighting: pending confirmation of the final weight variable. Analyses will default to unweighted diagnostic checks until `weight_variable` is populated, after which all estimates will be weighted.\n\n## Candidate Hypotheses (Descriptive/Associational)\n1. **H-A:** The weighted proportion of respondents who currently practice a religion (`religion`) differs by biological sex (`biomale`).\n2. **H-B:** Greater reported importance of childhood religious adherence (`externalreligion`) is associated with higher adult happiness relative to childhood (`I am happier as an adult than I was in childhood (h33e6gg)`).\n3. **H-C:** Respondents reporting higher current net worth brackets (`networth`) are more satisfied with their work or career (`I am satisfied with my work/career life (z0mhd63)`).\n4. **H-D:** Self-reported depression tendency (`I tend to suffer from depression (wz901dj)`) is positively associated with stress sensitivity (`I'm quite sensitive to stress (qhyti2r)-neg`).\n5. **H-E:** Older respondents (`selfage`) report higher counts of lifetime sexual partners (`How many people have you had sex with? (ewvvaz2)`).\n\n## Priority Hypotheses for Immediate Work\n### H1 (Priority: High)\n- **Statement:** The weighted proportion of active religious practice (`religion`) varies by biological sex (`biomale`).\n- **Estimand:** Difference in weighted proportions male vs. non-male.\n- **Approach:**\n  - Confirm weight and design variables from `docs/survey_design.yaml`.\n  - Use survey-weighted proportion estimates with 95% confidence intervals (Taylor linearization initially).\n  - Apply privacy guardrails by suppressing any subgroup estimate with n < 10.\n- **Diagnostics:** Assess missingness in `religion` and `biomale`; compare unweighted vs. weighted proportions.\n\n### H2 (Priority: Medium)\n- **Statement:** Higher childhood religious strictness (`externalreligion`) is associated with greater adult happiness change (`h33e6gg`).\n- **Estimand:** Survey-weighted difference in mean adult-vs-childhood happiness scores across terciles of `externalreligion`.\n- **Approach:**\n  - Confirm scale direction for both variables using the codebook.\n  - Construct terciles (or survey quantiles) of `externalreligion` with deterministic breaks.\n  - Estimate survey-weighted means and pairwise differences with Bonferroni-adjusted confidence intervals.\n  - Suppress cells where any tercile has <10 observations contributing to the estimate.\n- **Diagnostics:** Explore missing data patterns and perform sensitivity checks with unweighted comparisons.\n\n## Analysis Workflow Outline\n1. Validate design information (`T-001`).\n2. Produce weighted descriptive summaries for variables in H1 and H2 (`T-002`).\n3. Draft shell scripts for deterministic data processing once design metadata confirmed.\n4. Update manuscript (`manuscript.tex`) after each major analytic milestone to mirror Markdown findings.\n\n## Privacy and Quality Control\n- Enforce minimum cell size of 10 in all tables and plots.\n- Document QA steps in `qc/data_checks.md` with pass/fail status and regeneration commands.\n- Use deterministic seeds for any resampling or imputation; record seeds alongside outputs.\n\n## Manuscript Coordination\n- Maintain synchronized updates between Markdown narratives (e.g., `reports/`) and `manuscript.tex`.\n- Record versioned changes in git immediately after producing major artifacts (state updates, PAP revisions, hypotheses registry adjustments).\n\n## Outstanding TODOs Before Freezing PAP\n- Populate `docs/codebook.json` with full variable metadata.\n- Confirm survey design elements and update `config/agent_config.yaml` defaults.\n- Prototype analysis scripts to automate the above regeneration command.\n- Revisit hypotheses list after exploratory summaries to ensure feasibility and refine estimands.\n""",\n    "qc/data_checks.md": """# Data Quality Checklist (Bootstrap)\n\n- [ ] Confirm file integrity for `childhoodbalancedpublic_original.csv` (checksum pending).\n- [ ] Verify survey weight variable presence once metadata is populated in `docs/survey_design.yaml`.\n- [ ] Inspect missingness for key variables (`religion`, `biomale`, `externalreligion`, `h33e6gg`).\n- [ ] Validate categorical coding against `docs/codebook.json` once completed.\n- [ ] Record any data issues and remediation steps here before analysis loops proceed.\n\n**Regeneration command:** `python scripts/bootstrap_artifacts.py`\n""",\n    "notebooks/research_notebook.md": """# Research Notebook (Bootstrap Scaffold)\n\n**Seed:** 20251016  \n**Regeneration command:** `python scripts/bootstrap_artifacts.py`\n\n## Session 0 Overview\n- Initialized repository structure and placeholder metadata files.\n- Documented initial hypotheses and PAP priorities (see `analysis/pre_analysis_plan.md`).\n- Recorded backlog items in `artifacts/state.json`.\n\n## Planned Next Entries\n1. Validate survey design information and update weighting defaults.\n2. Run exploratory weighted summaries for religion and happiness variables.\n3. Document QA checks and sync findings with `manuscript.tex`.\n\n> Update this notebook after each analysis loop with commands run, seeds used, and outputs generated.\n""",\n    "lit/bibliography.bib": """% Bootstrap bibliography placeholder\n% Regeneration command: python scripts/bootstrap_artifacts.py\n\n@misc{TODO2025semantic,\n  title        = {TODO: Replace with Semantic Scholar export once literature search is run},\n  author       = {TODO},\n  year         = {2025},\n  howpublished = {Semantic Scholar API query pending},\n  note         = {Record query string and access date.}\n}\n""",\n    "lit/evidence_map.csv": """query,source_id,title,relevance,notes\n\\\"TODO: semantic scholar query string\\\",,\\\"\\\",,\\\"Populate after literature scan; ensure query logged.\\\"\n"""\n}\n\n\ndef write_file(base: Path, relative_path: str, content: str) -> None:\n    path = base / relative_path\n    path.parent.mkdir(parents=True, exist_ok=True)\n    path.write_text(content, encoding=\"utf-8\")\n    print(f\"Wrote {relative_path}\")\n\n\ndef main() -> None:\n    repo_root = Path(__file__).resolve().parents[1]\n    for rel, content in FILES.items():\n        write_file(repo_root, rel, content)\n\n\nif __name__ == \"__main__\":\n    main()\n